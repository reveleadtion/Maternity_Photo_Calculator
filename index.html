<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>When to Take Maternity Photos | Two Wild Souls Photography</title>

    <!-- Meta Pixel -->
    <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
    n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}
    (window, document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1484618222285119');
    fbq('track', 'PageView');
    </script>
    <noscript>
      <img height="1" width="1" style="display:none"
        src="https://www.facebook.com/tr?id=1484618222285119&ev=PageView&noscript=1"/>
    </noscript>

    <style>
    @import url("https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;1,400;1,500&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap");

    :root {
        --bg: #FAFAF7;
        --text: #2E2F2C;
        --text-light: #6B6E6A;
        --accent: #7C8A5A;
        --gold: #C7B27A;
        --deep: #3F4438;
        --border: #DDD9D3;
        --error: #bf5040;
    }

    * { margin:0; padding:0; box-sizing:border-box; }
    body {
        font-family: "DM Sans", sans-serif;
        background: var(--bg);
        color: var(--text);
        line-height: 1.65;
        min-height: 100vh;
        padding: 40px 20px 100px;
    }

    .container { max-width: 820px; margin: 0 auto; }

    .header { text-align: center; padding: 0 0 48px; }
    .header .eyebrow { font-size: 11px; font-weight: 500; letter-spacing: 0.32em; text-transform: uppercase; color: var(--gold); margin-bottom: 12px; }
    .header h1 { font-family: "Playfair Display", serif; font-size: clamp(32px, 7vw, 48px); font-weight: 400; line-height: 1.15; margin-bottom: 16px; }
    .header h1 em { color: var(--gold); font-style: italic; }
    .header p { font-size: 17px; color: var(--text-light); max-width: 640px; margin: 0 auto; }

    .progress-bar { height: 4px; background: rgba(124,138,90,0.12); margin: 0 0 40px; border-radius: 2px; overflow: hidden; }
    .progress-fill { height: 100%; width: 0%; background: linear-gradient(90deg, var(--accent), var(--gold)); transition: width 0.5s ease; }

    .dots { display: flex; justify-content: center; gap: 10px; margin: 0 0 32px; }
    .dot { width: 8px; height: 8px; border-radius: 50%; background: #E0DDD8; transition: all 0.3s; }
    .dot.active { background: var(--accent); transform: scale(1.4); }
    .dot.completed { background: var(--gold); transform: scale(1.1); }

    .step { display: none; }
    .step.active { display: block; }

    .question { font-family: "Playfair Display", serif; font-size: clamp(24px, 5vw, 32px); font-weight: 400; line-height: 1.25; margin: 0 0 12px; text-align: center; }
    .hint { font-size: 15px; color: var(--text-light); font-style: italic; text-align: center; margin: 0 0 28px; max-width: 600px; margin-left: auto; margin-right: auto; }

    .options { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 16px; margin: 0 0 32px; }
    .option {
        padding: 20px 24px; border: 2px solid var(--border); border-radius: 6px;
        cursor: pointer; transition: all 0.2s; background: white; text-align: center;
    }
    .option:hover { border-color: var(--accent); background: rgba(124,138,90,0.04); }
    .option.selected { border-color: var(--accent); background: rgba(124,138,90,0.08); box-shadow: 0 0 0 3px rgba(124,138,90,0.15); }
    .option-title { font-size: 17px; font-weight: 500; margin-bottom: 6px; }
    .option-desc { font-size: 14px; color: var(--text-light); }

    .date-picker {
        width: 100%; max-width: 420px; margin: 0 auto 32px; padding: 18px 24px;
        font-size: 17px; background: white; border: 2px solid var(--border);
        border-radius: 6px; cursor: pointer; text-align: center; transition: all 0.2s;
    }
    .date-picker:hover, .date-picker:focus { border-color: var(--accent); box-shadow: 0 0 0 4px rgba(124,138,90,0.12); }
    .date-placeholder { color: var(--text-light); }

    .checkbox-option { display: flex; align-items: center; gap: 12px; padding: 16px; border: 2px solid var(--border); border-radius: 6px; cursor: pointer; background: white; transition: all 0.2s; }
    .checkbox-option:hover { border-color: var(--accent); background: rgba(124,138,90,0.04); }
    .checkbox-option.selected { border-color: var(--accent); background: rgba(124,138,90,0.08); }
    .checkbox-label { font-size: 17px; font-weight: 500; }

    .buttons { display: flex; gap: 16px; justify-content: center; flex-wrap: wrap; margin-top: 40px; }
    .btn {
        padding: 16px 36px; font-size: 14px; font-weight: 500; letter-spacing: 0.08em;
        text-transform: uppercase; border-radius: 6px; cursor: pointer; transition: all 0.2s; min-width: 160px;
    }
    .btn-back { background: transparent; border: 2px solid var(--border); color: var(--text-light); }
    .btn-back:hover { border-color: var(--text); color: var(--text); }
    .btn-next { background: var(--deep); color: white; border: none; }
    .btn-next:hover { background: var(--accent); }
    .btn-gold { background: linear-gradient(90deg, var(--accent), var(--gold)); color: white; border: none; }

    .error-msg { color: var(--error); font-size: 14px; text-align: center; margin: 12px 0; display: none; }
    .error-msg.show { display: block; }

    .loading-screen { text-align: center; padding: 100px 20px; display: none; }
    .spinner {
        width: 48px; height: 48px; border: 5px solid rgba(124,138,90,0.2);
        border-top: 5px solid var(--accent); border-radius: 50%;
        animation: spin 1s linear infinite; margin: 0 auto 24px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Calendar */
    #calendar-overlay {
        display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.65);
        z-index: 1000; align-items: center; justify-content: center; padding: 20px;
    }
    #calendar-overlay.open { display: flex; }
    .calendar {
        background: white; border-radius: 8px; box-shadow: 0 20px 60px rgba(0,0,0,0.35);
        max-width: 360px; width: 100%; overflow: hidden;
    }
    .cal-header { display: flex; align-items: center; justify-content: space-between; padding: 16px 20px; background: #F7F5F1; border-bottom: 1px solid var(--border); }
    .cal-header button { background: none; border: none; font-size: 24px; color: var(--deep); cursor: pointer; padding: 0 12px; }
    .cal-header span { font-family: "Playfair Display", serif; font-size: 18px; font-weight: 500; }
    .cal-weekdays { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; font-size: 12px; font-weight: 500; color: var(--text-light); padding: 12px 0; background: #F7F5F1; }
    .cal-days-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; padding: 12px; }
    .cal-day {
        aspect-ratio: 1; display: flex; align-items: center; justify-content: center;
        font-size: 15px; border-radius: 50%; cursor: pointer; transition: all 0.15s;
    }
    .cal-day:hover:not(.disabled):not(.empty) { background: rgba(124,138,90,0.1); }
    .cal-day.selected { background: var(--accent); color: white; font-weight: 600; }
    .cal-day.disabled { color: #ccc; cursor: not-allowed; }
    .cal-day.empty { background: transparent; cursor: default; }
    .cal-footer { padding: 16px; text-align: right; border-top: 1px solid var(--border); }
    .cal-footer button { padding: 10px 20px; margin-left: 12px; border: none; border-radius: 6px; cursor: pointer; }
    .cal-footer .btn-cancel { background: #eee; color: #555; }
    .cal-footer .btn-done  { background: var(--accent); color: white; }

    @media (max-width: 640px) {
        .options { grid-template-columns: 1fr; }
        .buttons { flex-direction: column; }
        .btn { width: 100%; }
    }
    </style>
</head>
<body>

<div class="container">
    <header class="header">
        <div class="eyebrow">Find Your Perfect Timing</div>
        <h1>When Should You Book Your <em>Maternity Photos</em>?</h1>
        <p>Answer a few quick questions — get your personalized window, booking urgency, and tips tailored to your situation in Metro Detroit.</p>
    </header>

    <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
    <div class="dots" id="dots"></div>

    <!-- Step 1: Due Date -->
    <div class="step active" id="step-1">
        <div class="question">What's your expected due date?</div>
        <div class="hint">We'll use this to calculate your current week and ideal photo timing.</div>
        <div class="date-picker" id="date-display" onclick="openCalendar()">
            <span id="selected-date" class="date-placeholder">Tap to select due date...</span>
        </div>
        <div class="error-msg" id="error-1">Please select a valid due date to continue.</div>
    </div>

    <!-- Step 2: First Baby -->
    <div class="step" id="step-2">
        <div class="question">Is this your first baby?</div>
        <div class="hint">First-time moms often show later — this adjusts your ideal window.</div>
        <div class="options">
            <div class="option" data-value="yes" onclick="selectOption(this, 'firstBaby', 2, 3)">
                <div class="option-title">Yes, first baby!</div>
                <div class="option-desc">Excited for the journey</div>
            </div>
            <div class="option" data-value="no" onclick="selectOption(this, 'firstBaby', 2, 3)">
                <div class="option-title">No, we've done this before</div>
                <div class="option-desc">Experienced parents</div>
            </div>
        </div>
        <div class="error-msg" id="error-2">Please make a selection.</div>
        <div class="buttons">
            <button class="btn btn-back" onclick="goToStep(1)">Back</button>
        </div>
    </div>

    <!-- Step 3: Multiples -->
    <div class="step" id="step-3">
        <div class="question">Are you expecting multiples?</div>
        <div class="hint">Twins or more? We recommend earlier sessions for comfort.</div>
        <div class="options">
            <div class="option" data-value="yes" onclick="selectOption(this, 'multiples', 3, 4)">
                <div class="option-title">Yes</div>
                <div class="option-desc">Twins, triplets, etc.</div>
            </div>
            <div class="option" data-value="no" onclick="selectOption(this, 'multiples', 3, 4)">
                <div class="option-title">No</div>
                <div class="option-desc">Single baby</div>
            </div>
        </div>
        <div class="error-msg" id="error-3">Please make a selection.</div>
        <div class="buttons">
            <button class="btn btn-back" onclick="goToStep(2)">Back</button>
        </div>
    </div>

    <!-- Step 4: Vibe + Setting -->
    <div class="step" id="step-4">
        <div class="question">What's your session vibe?</div>
        <div class="hint">Choose the experience that fits your vision.</div>
        <div class="options">
            <div class="option" data-value="full" onclick="selectOption(this, 'vibe', null, null)">
                <div class="option-title">Full Experience</div>
                <div class="option-desc">Timeless, luxurious portraits</div>
            </div>
            <div class="option" data-value="petite" onclick="selectOption(this, 'vibe', null, null)">
                <div class="option-title">Petite Session</div>
                <div class="option-desc">Quick, essential captures</div>
            </div>
        </div>

        <div class="question" style="margin-top: 32px;">Preferred setting?</div>
        <div class="hint">This influences timing for weather or comfort.</div>
        <div class="options">
            <div class="option" data-value="outdoor" onclick="selectOption(this, 'setting', 4, 5)">
                <div class="option-title">Outdoor</div>
                <div class="option-desc">Natural light, scenic locations</div>
            </div>
            <div class="option" data-value="indoor" onclick="selectOption(this, 'setting', 4, 5)">
                <div class="option-title">Indoor/Studio</div>
                <div class="option-desc">Controlled, intimate</div>
            </div>
            <div class="option" data-value="both" onclick="selectOption(this, 'setting', 4, 5)">
                <div class="option-title">Both</div>
                <div class="option-desc">Mix of outdoor & indoor</div>
            </div>
        </div>
        <div class="error-msg" id="error-4">Please select both vibe and setting.</div>
        <div class="buttons">
            <button class="btn btn-back" onclick="goToStep(3)">Back</button>
        </div>
    </div>

    <!-- Step 5: High-risk -->
    <div class="step" id="step-5">
        <div class="question">Any special considerations?</div>
        <div class="hint">This refines your recommendation. Skip if none apply.</div>
        <div class="options" style="grid-template-columns: 1fr;">
            <div class="checkbox-option" onclick="toggleCheckbox(this, 'highRisk')">
                <input type="checkbox" id="highRisk" style="display:none;">
                <div class="checkbox-label">High-risk pregnancy</div>
                <div style="font-size:14px; color:var(--text-light); font-style:italic;">We recommend scheduling earlier</div>
            </div>
        </div>
        <div class="buttons">
            <button class="btn btn-back" onclick="goToStep(4)">Back</button>
            <button class="btn btn-gold" onclick="calculateAndRedirect()">See My Recommendation →</button>
        </div>
    </div>

    <div class="loading-screen" id="loading">
        <div class="spinner"></div>
        <h2>Creating Your Personalized Plan…</h2>
        <p>Just a moment</p>
    </div>
</div>

<!-- Calendar Modal -->
<div id="calendar-overlay">
    <div class="calendar">
        <div class="cal-header">
            <button onclick="changeMonth(-1)">‹</button>
            <span id="cal-header"></span>
            <button onclick="changeMonth(1)">›</button>
        </div>
        <div class="cal-weekdays">
            <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div>
            <div>Thu</div><div>Fri</div><div>Sat</div>
        </div>
        <div id="cal-days-grid" class="cal-days-grid"></div>
        <div class="cal-footer">
            <button class="btn btn-cancel" onclick="closeCalendar()">Cancel</button>
            <button class="btn btn-done" onclick="closeCalendar()">Done</button>
        </div>
    </div>
</div>

<script>
// ────────────────────────────────────────────────
// State
// ────────────────────────────────────────────────
const state = {
    dueDate: null,
    firstBaby: null,
    multiples: null,
    vibe: null,
    setting: null,
    highRisk: false
};

let currentStep = 1;
const totalSteps = 5;

const today = new Date(); today.setHours(0,0,0,0);
const MIN_DAYS_FROM_TODAY = 56;
const minDueDate = new Date(today); minDueDate.setDate(minDueDate.getDate() + MIN_DAYS_FROM_TODAY);

const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
let calYear = today.getFullYear();
let calMonth = today.getMonth();

// ────────────────────────────────────────────────
// DOM Helpers
// ────────────────────────────────────────────────
function safeGet(id) { return document.getElementById(id); }

// ────────────────────────────────────────────────
// Progress
// ────────────────────────────────────────────────
function updateProgress() {
    const fill = safeGet('progress-fill');
    if (fill) fill.style.width = `${(currentStep / totalSteps) * 100}%`;

    const dots = safeGet('dots');
    if (dots) {
        dots.innerHTML = '';
        for (let i = 1; i <= totalSteps; i++) {
            const d = document.createElement('div');
            d.className = 'dot';
            if (i === currentStep) d.classList.add('active');
            if (i < currentStep) d.classList.add('completed');
            dots.appendChild(d);
        }
    }
}

// ────────────────────────────────────────────────
// Navigation
// ────────────────────────────────────────────────
function goToStep(step) {
    document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
    const target = safeGet(`step-${step}`);
    if (target) target.classList.add('active');
    currentStep = step;
    updateProgress();
}

// ────────────────────────────────────────────────
// Option Selection (auto-advance)
function selectOption(el, key, fromStep, nextStep) {
    const group = el.parentElement;
    group.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
    el.classList.add('selected');
    state[key] = el.dataset.value;

    if (nextStep) setTimeout(() => goToStep(nextStep), 400);
}

// ────────────────────────────────────────────────
// Checkbox
function toggleCheckbox(el, key) {
    const input = el.querySelector('input');
    input.checked = !input.checked;
    el.classList.toggle('selected', input.checked);
    state[key] = input.checked;
}

// ────────────────────────────────────────────────
// Calendar
// ────────────────────────────────────────────────
function openCalendar() {
    const overlay = safeGet('calendar-overlay');
    if (!overlay) return;

    if (state.dueDate) {
        calYear = state.dueDate.getFullYear();
        calMonth = state.dueDate.getMonth();
    } else {
        let test = new Date(minDueDate);
        calYear = test.getFullYear();
        calMonth = test.getMonth();
        while (!hasSelectableDaysInMonth(calYear, calMonth)) {
            calMonth++;
            if (calMonth > 11) { calMonth = 0; calYear++; }
        }
    }

    renderCalendar();
    overlay.classList.add('open');
}

function closeCalendar() {
    const overlay = safeGet('calendar-overlay');
    if (overlay) overlay.classList.remove('open');
}

function changeMonth(dir) {
    calMonth += dir;
    if (calMonth < 0) { calMonth = 11; calYear--; }
    if (calMonth > 11) { calMonth = 0; calYear++; }
    renderCalendar();
}

function hasSelectableDaysInMonth(y, m) {
    return new Date(y, m + 1, 0) >= minDueDate;
}

function renderCalendar() {
    const header = safeGet('cal-header');
    if (header) header.textContent = `${months[calMonth]} ${calYear}`;

    const grid = safeGet('cal-days-grid');
    if (!grid) return;
    grid.innerHTML = '';

    const first = new Date(calYear, calMonth, 1).getDay();
    const days = new Date(calYear, calMonth + 1, 0).getDate();

    for (let i = 0; i < first; i++) {
        const e = document.createElement('div');
        e.className = 'cal-day empty';
        grid.appendChild(e);
    }

    for (let d = 1; d <= days; d++) {
        const date = new Date(calYear, calMonth, d);
        date.setHours(0,0,0,0);

        const day = document.createElement('div');
        day.className = 'cal-day';
        day.textContent = d;

        if (date < minDueDate) {
            day.classList.add('disabled');
        } else {
            day.onclick = () => {
                state.dueDate = date;
                const disp = safeGet('selected-date');
                if (disp) {
                    disp.textContent = date.toLocaleDateString('en-US', {month:'long', day:'numeric', year:'numeric'});
                    disp.classList.remove('date-placeholder');
                }
                closeCalendar();
                setTimeout(() => goToStep(2), 300);
            };

            if (state.dueDate && state.dueDate.toDateString() === date.toDateString()) {
                day.classList.add('selected');
            }
        }
        grid.appendChild(day);
    }
}

// ────────────────────────────────────────────────
// Final Calculation & Redirect
// ────────────────────────────────────────────────
function calculateAndRedirect() {
    document.querySelectorAll('.step').forEach(s => s.style.display = 'none');
    const loading = safeGet('loading');
    if (loading) loading.style.display = 'block';

    setTimeout(() => {
        const due = state.dueDate;
        const isFirst = state.firstBaby === 'yes';
        const multiples = state.multiples === 'yes';
        const vibe = state.vibe;
        const setting = state.setting;
        const highRisk = state.highRisk;

        const conception = new Date(due.getTime() - 280 * 86400000);
        const daysSince = Math.floor((today - conception) / 86400000);
        const currentWeek = Math.max(1, Math.min(42, Math.ceil(daysSince / 7)));

        let start = multiples ? 24 : (isFirst ? (vibe === 'full' ? 30 : 28) : (vibe === 'full' ? 28 : 26));
        let end   = multiples ? 28 : (isFirst ? (vibe === 'full' ? 34 : 32) : (vibe === 'full' ? 32 : 30));

        if (!multiples) {
            if (setting === 'outdoor') { start = Math.max(20, start - 2); end = Math.max(22, end - 2); }
            if (setting === 'indoor')  { start = Math.min(32, start + 1); end = Math.min(34, end + 1); }
        }
        if (highRisk && !multiples) { start = Math.max(20, start - 2); end = Math.max(22, end - 2); }

        end = Math.min(end, 32);
        start = Math.min(start, 32);

        const isLate   = currentWeek >= 33;
        const isUrgent = currentWeek === 32;
        const isInWindow = currentWeek >= start && currentWeek <= end && !isUrgent && !isLate;

        let context = 'early';
        if (isLate || isUrgent) context = 'late';
        else if (isInWindow) context = 'inWindow';
        else if (currentWeek > end) context = 'pastWindow';

        const maternityUrl = 'https://twowildsoulsphotography.com/detroit-maternity-photographer-ads-custom';
        const newbornUrl   = 'https://twowildsoulsphotography.com/detroit-newborn-photographer-ads';
        const dest = isLate ? newbornUrl : maternityUrl;

        let bookBy = '';
        if (!isLate && !isUrgent) {
            const bookDate = new Date(conception);
            bookDate.setDate(bookDate.getDate() + start * 7 - 42);
            bookBy = bookDate.toLocaleDateString('en-US', {month:'long', day:'numeric', year:'numeric'});
        } else if (isUrgent) {
            bookBy = 'Today';
        }

        const params = new URLSearchParams({
            week: currentWeek,
            status: context,
            window: isLate || isUrgent ? '' : `${start}-${end}`,
            bookby: bookBy,
            type: isLate ? 'newborn' : 'maternity',
            vibe: vibe || '',
            setting: setting || '',
            duedate: due.toLocaleDateString('en-US', {month:'long', day:'numeric', year:'numeric'})
        });

        const fbclid = new URLSearchParams(window.location.search).get('fbclid');
        if (fbclid) params.append('fbclid', fbclid);

        try {
            fbq('track', 'Lead', { content_name: 'Calculator Complete', content_category: context, value: currentWeek, currency: 'USD' });
        } catch(e) {}

        window.location.href = `${dest}?${params.toString()}`;
    }, 1600);
}

// ────────────────────────────────────────────────
// Init
// ────────────────────────────────────────────────
document.addEventListener('DOMContentLoaded', () => {
    updateProgress();

    const overlay = safeGet('calendar-overlay');
    if (overlay) {
        overlay.addEventListener('click', e => {
            if (e.target === overlay) closeCalendar();
        });
    }
});
</script>

</body>
</html>
